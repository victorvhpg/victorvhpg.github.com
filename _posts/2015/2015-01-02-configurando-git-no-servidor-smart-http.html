---
layout: post
title: Configurando Git no servidor - "smart" HTTP
date: '2015-01-02T15:54:00.000-08:00'
author: Victor Hugo
tags:
- linux
- git
- dicas
- ubuntu
modified_time: '2015-01-02T17:03:34.011-08:00'
thumbnail: http://1.bp.blogspot.com/-tB9s94zI3RY/VKXbdU1QY_I/AAAAAAAAAz0/jBXXn4BC7EI/s72-c/git.png
blogger_id: tag:blogger.com,1999:blog-6860482956411468594.post-5153916415448973424
blogger_orig_url: http://victorvhpg.blogspot.com/2015/01/configurando-git-no-servidor-smart-http.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-tB9s94zI3RY/VKXbdU1QY_I/AAAAAAAAAz0/jBXXn4BC7EI/s1600/git.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-tB9s94zI3RY/VKXbdU1QY_I/AAAAAAAAAz0/jBXXn4BC7EI/s1600/git.png" height="133" width="320" /></a></div><br /><br />Hoje vou demonstrar como configurar o Git num servidor Linux usando Apache como server, com o protocolo HTTP("smart" HTTP),&nbsp; permitindo a colaboração dos membros de sua equipe. <br />Tenho utilizado Git há 4 anos em projetos particulares e nos meus experimentos, no trabalho utilizo uma "solução" da Microsoft. Sem duvida nenhuma Git&nbsp; é o melhor controle de versão existente, não da&nbsp; nem pra comparar com os outros, Git é de longe o melhor, não há motivos técnicos para não usá-lo, além de ser muito simples aprender a utiliza-lo (a menos que você seja apenas um usuário de IDE que só sabe clicar, igual um macaco treinado LOL... ai fica um pouco difícil, mas vai acabar sendo treinado com o tempo). Nunca precisei configurar um servidor Git, pois utilizo serviços como GitHub e Bitbucket, mas configurar o Git num servidor pra rodar numa intranet é bem simples e pode ser feito de várias maneiras.<br />O Git suporta os seguintes protocolos: Local, HTTP("smart" HTTP), SSH e protocolo Git. Atualmente o protocolo HTTP ("smart" HTTP) tem sido o mais utilizado. Ele é chamado de "smart" HTTP pois antigamente&nbsp; existia o suporte HTTP, mas ele era muito limitado, mas na versão 1.6.6 do Git, o suporte ao protocolo HTTP recebeu grandes melhorias, tornando-se excelente, ficando conhecido como "smart" HTTP, com ele você pode ter acesso anônimo ou autenticado com criptografia.<br />Para rodar o Git com o protocolo HTTP é necessário um servidor com suporte a CGI, pois quem vai fazer todo o trabalho é um script CGI chamado<i> git-http-backend</i> que já vem junto com o Git, eu utilizei o Apache mas poderia ser qualquer outro servidor com suporte a CGI.<br /><br />O que foi utilizado nesta demonstração:   <br /><ul><li> Ubuntu  14.04-LTS</li><li> Git  2.2.1</li><li> Apache  2.4.7</li></ul><h2>Instalando o Git</h2>Você pode instalar o Git com   apt-get  ou se você quiser  a versão mais recente do Git, você pode baixar o código-fonte dele e compilar. <br /><div data-gist="https://gist.github.com/victorvhpg/5853429a825c94314884"></div>Recomendo que compile a ultima versão, depois você pode clonar o repositório do Git, e fazer um <i>pull</i> ou <i>fetch+merge</i>  para receber as atualizações direto do repositório.  <br />git clone git://git.kernel.org/pub/scm/git/git.git    <br /><h2>  Configuração do servidor Apache </h2>Para instalar o Apache:  <br /><div data-gist="https://gist.github.com/victorvhpg/8e86b101b4d75699536b"></div>Habilitar módulos  mod_cgi, mod_alias, mod_env e auth_digest do Apache:  <br /><div data-gist="https://gist.github.com/victorvhpg/8059d94d61b34bd90aa9"></div>Depois de ter instalado o apache e os módulos, é necessário criar um "Virtual Host" onde o Git rodará na intranet, eu utilizei este domínio de exemplo: http://git.exemplo/, para fins de testes eu configurei o meu /etc/hosts com este domínio.  <br /><b>Configuração do arquivo <i>/etc/apache2/sites-available/git.conf</i> :    </b><br />Crie um arquivo  'Virtual Host' chamado git.conf, nele estão setadas variáveis de ambiente do apache para dizer onde estão os repositórios Git, configura o apache para que toda URL que tiver /git seja manipulada pelo CGI <b>git-http-backend</b> e como o apache deve lidar com a autenticação. <br /><ul><li>Local onde estão os repositórios Git:<b> /var/www/git/git</b> </li><li>Local do arquivo de autenticação dos usuários: <b>/var/www/git/.htpasswd</b> </li></ul>Arquivo /etc/apache2/sites-available/git.conf: <div data-gist="https://gist.github.com/victorvhpg/2c7b9531920b01119474"></div>Obs: O   arquivo <i><b>/var/www/git/.htpasswd</b></i>  é o arquivo onde estão os usuários, para criar um usuário no apache utilize o comando <b>htdigest<i></i></b>. Por exemplo:    <div data-gist="https://gist.github.com/victorvhpg/d646448e542c75d28e85"></div>      Após criar o arquivo git.conf  é necessário ativa-lo e reiniciar o apache: <br /><div data-gist="https://gist.github.com/victorvhpg/1f34693a7e042b87f1cb"></div>  <h2>Criando um repositório Git Remoto</h2><p>Agora que o servidor já está configurado é necessário criar o repositório remoto. O repositório deve ficar no local que foi configurado no apache: <i><b>/var/www/git/git</b></i>.  <div data-gist="https://gist.github.com/victorvhpg/cffaf34b08fdd51fb70d"></div>Pronto ;) agora seus amiguinhos podem colaborar neste repositório remoto através da rede utilizando o Git. <br />    </p>Um usuário previamente criado no /var/www/git/.htpasswd  que tenha acesso ao servidor na rede, após autenticação pode fazer um <b>git clone</b> e começar a colaborar neste repositório. <div data-gist="https://gist.github.com/victorvhpg/b74c50156a4f3960c1c3"></div><iframe width="560" height="315" src="//www.youtube.com/embed/70qOOtwEp80" frameborder="0" allowfullscreen></iframe><br /> <h2>Referências</h2><ul><li><a href="http://git-scm.com/book/en/v2/Git-on-the-Server-The-Protocols" target="_blank"> Livro Pro Git - segunda edição </a></li><li><a href="https://www.kernel.org/pub/software/scm/git/docs/git-http-backend.html" target="_blank"> https://www.kernel.org/pub/software/scm/git/docs/git-http-backend.html </a></li><li><a href="http://httpd.apache.org/docs/current/howto/auth.html" target="_blank"> http://httpd.apache.org/docs/current/howto/auth.html</a></li></ul> <script> carregaGist.init(); </script><br />